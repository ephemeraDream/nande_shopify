<div class="product_info_modal_item">
  <div class="product_info_modal_item_left">
    {{ icon }}
    <span class="product_info_modal_item_title">{{ title }}</span>
  </div>
  {{- 'swiper-right.svg' | inline_asset_content -}}

  <div class="common_modal">
    <div class="common_modal_contain">
      <div class="common_modal_head">
        <span></span>
        <div class="common_modal_close">{{- 'icon-close.svg' | inline_asset_content -}}</div>
      </div>
      <div class="common_modal_body">
        <div class="product_info_modal_title">{{ modal_title }}</div>
        <div class="product_info_modal_content">{{ modal_content }}</div>
        {%- form 'contact', id: 'ContactForm', class: contact_form_class -%}
          <input
            autocomplete="email"
            type="email"
            class="field-input"
            name="contact[email]"
            spellcheck="false"
            autocapitalize="off"
            value="{% if form.email %}{{ form.email }}{% elsif customer %}{{ customer.email }}{% endif %}"
            placeholder="Emal*"
            required
          >
          <input
            class="field-input"
            type="text"
            name="contact[Unternehmen]"
            placeholder="Unternehmen (optional)"
          >
          <input
            class="field-input"
            autocomplete="name"
            type="text"
            name="contact[Name]"
            value="{% if form.name %}{{ form.name }}{% elsif customer %}{{ customer.name }}{% endif %}"
            placeholder="Name (optional)"
          >
          <textarea
            rows="6"
            id="ContactForm-body"
            class="field-input"
            name="contact[Nachricht]"
            placeholder="Nachricht (optional)"
          >
              {{- form.body -}}
            </textarea>
          <div class="contact-btn">
            <button type="submit" class="submit-button-t" id="ContactForm-submit">
              {{ 'common.absenden' | t -}}
              {{- 'icon-commit.svg' | inline_asset_content }}
            </button>
          </div>
        {%- endform -%}
        {% comment %}
          <form id="ContactForm" action="/contact" method="post" accept-charset="UTF-8" class="contact_form_class">
            <input
              autocomplete="email"
              type="email"
              class="field-input"
              name="contact[email]"
              spellcheck="false"
              autocapitalize="off"
              value="{% if form.email %}{{ form.email }}{% elsif customer %}{{ customer.email }}{% endif %}"
              placeholder="Emal*"
              required
            >
            <input
              class="field-input"
              type="text"
              name="contact[Unternehmen]"
              placeholder="Unternehmen (optional)"
            >
            <input
              class="field-input"
              autocomplete="name"
              type="text"
              name="contact[Name]"
              value="{% if form.name %}{{ form.name }}{% elsif customer %}{{ customer.name }}{% endif %}"
              placeholder="Name (optional)"
            >
            <textarea
              rows="6"
              id="ContactForm-body"
              class="field-input"
              name="contact[Nachricht]"
              placeholder="Nachricht (optional)"
            >
                {{- form.body -}}
              </textarea>
            <div class="contact-btn">
              <button type="submit">
                {{ 'common.absenden' | t -}}
                {{- 'icon-commit.svg' | inline_asset_content }}
              </button>
            </div>
          </form>
        {% endcomment %}

        <div id="ContactForm-message" style="display:none;"></div>
        <div class="product_info_modal_tip">{{ modal_tip }}</div>
      </div>
    </div>
  </div>
</div>

<style>
  .submit-button-t.loading {
    position: relative;
    pointer-events: none;
    color: transparent;
  }
  
  .submit-button-t.loading::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 20px;
    height: 20px;
    border: 2px solid transparent;
    border-top: 2px solid currentColor;
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }
  
  @keyframes spin {
    0% { transform: translate(-50%, -50%) rotate(0deg); }
    100% { transform: translate(-50%, -50%) rotate(360deg); }
  }
  </style>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const form = document.getElementById('ContactForm');
      const submitBtn = document.getElementById('ContactForm-submit');
      
      if (form && submitBtn) {
        form.addEventListener('submit', function() {
          // 添加loading状态
          submitBtn.classList.add('loading');
          submitBtn.setAttribute('aria-disabled', 'true');
          submitBtn.disabled = true;
        });
      }
    });
    </script>
