{{ 'section-header-simple.css' | asset_url | stylesheet_tag }}

<style>
  #shopify-section-{{ section.id }} {
    z-index: 1002;
  }
  /* 确保语言切换器在手机端也能对齐 */
  .header_simple_lang_switcher {
    display: flex;
    align-items: center;
    margin-right: 15px;
  }
  .lang-link {
    text-decoration: none;
    font-size: 13px;
    font-weight: 500;
    transition: opacity 0.2s;
    color: #000; /* 默认黑色，如果页首是黑底请改为 #fff */
  }
  .lang-link.active {
    border-bottom: 1.5px solid currentColor;
    opacity: 1;
  }
  .lang-link.inactive {
    opacity: 0.4;
  }
</style>

<div class="header_simple_section padding-sider">
  <div class="header_simple">
    <a href="{{ routes.root_url }}" class="header_simple_logo">
      <div class="header__heading-logo-wrapper">
        {%- assign logo_alt = settings.logo.alt | default: shop.name | escape -%}
        {%- assign logo_height = settings.logo_width | divided_by: settings.logo.aspect_ratio -%}
        {% capture sizes %}(max-width: {{ settings.logo_width | times: 2 }}px) 50vw, {{ settings.logo_width }}px{% endcapture %}
        {% capture widths %}{{ settings.logo_width }}, {{ settings.logo_width | times: 1.5 | round }}, {{ settings.logo_width | times: 2 }}{% endcapture %}
        {{
          settings.logo
          | image_url: width: 600
          | image_tag:
            class: 'header__heading-logo motion-reduce',
            widths: widths,
            height: logo_height,
            width: settings.logo_width,
            alt: logo_alt,
            sizes: sizes,
            preload: true
        }}
      </div>
    </a>
    <div class="header_simple_search">
      <predictive-search class="search-modal__form" data-loading-text="{{ 'accessibility.loading' | t }}">
        <form action="{{ routes.search_url }}" method="get" role="search" class="search search-modal__form">
          <div class="field">
            <input
              class="search__input field__input"
              id="Search-In-Out"
              type="search"
              name="q"
              value="{{ search.terms | escape }}"
              placeholder="{{ 'general.search.search' | t }}"
              role="combobox"
              aria-expanded="false"
              aria-owns="predictive-search-results"
              aria-controls="predictive-search-results"
              aria-haspopup="listbox"
              aria-autocomplete="list"
              autocorrect="off"
              autocomplete="off"
              autocapitalize="off"
              spellcheck="false"
            >
            <label class="field__label" for="Search-In-Out">{{ 'general.search.search' | t }}</label>
            <input type="hidden" name="options[prefix]" value="last">
            <button
              type="reset"
              class="reset__button field__button{% if search.terms == blank %} hidden{% endif %}"
              aria-label="{{ 'general.search.reset' | t }}"
            >
              <span class="svg-wrapper">
                {{- 'icon-reset.svg' | inline_asset_content -}}
              </span>
            </button>
            <button class="search__button field__button" aria-label="{{ 'general.search.search' | t }}">
              <span class="svg-wrapper">
                {{- 'icon-search.svg' | inline_asset_content -}}
              </span>
            </button>
          </div>

          <div class="predictive-search predictive-search--header" tabindex="-1" data-predictive-search>
            {%- render 'loading-spinner', class: 'predictive-search__loading-state' -%}
          </div>

          <span class="predictive-search-status visually-hidden" role="status" aria-hidden="true"></span>
        </form>
      </predictive-search>
    </div>

    <div class="header_simple_icon_box">
      <div class="header_simple_lang_switcher">
        {%- form 'localization', id: 'HeaderLanguageForm' -%}
          <input type="hidden" name="language_code" id="HeaderLanguageCode" value="{{ localization.language.iso_code }}">
          <div style="display: flex; gap: 10px;">
            {%- for language in localization.available_languages -%}
              <a href="#" 
                 onclick="document.getElementById('HeaderLanguageCode').value = '{{ language.iso_code }}'; this.closest('form').submit(); return false;"
                 class="lang-link {% if language.iso_code == localization.language.iso_code %}active{% else %}inactive{% endif %}"
              >
                {{ language.iso_code | uppercase }}
              </a>
            {%- endfor -%}
          </div>
        {%- endform -%}
      </div>
      {%- if shop.customer_accounts_enabled -%}
        <a
          href="{%- if customer -%}{{ routes.account_url }}{%- else -%}{{ routes.account_login_url }}{%- endif -%}"
          class="header_simple_icon_item"
        >
          {{ 'icon-account.svg' | inline_asset_content }}
        </a>
      {%- endif -%}
      <a href="{{ routes.cart_url }}" class="header_simple_icon_item" id="cart-icon-bubble">
        {%- if section.settings.cart_icon_svg != blank -%}
          {{ section.settings.cart_icon_svg }}
        {%- else -%}
          {{ 'icon-cart-empty.svg' | inline_asset_content }}
        {%- endif -%}
        {%- if cart != empty -%}
          <div class="cart-count-bubble">
            {%- if cart.item_count < 100 -%}
              <span aria-hidden="true">{{ cart.item_count }}</span>
            {%- endif -%}
            <span class="visually-hidden">{{ 'sections.header.cart_count' | t: count: cart.item_count }}</span>
          </div>
        {%- endif -%}
      </a>
      <a href="mailto:{{ shop.email }}" class="header_simple_icon_item">
        {%- if section.settings.email_icon_svg != blank -%}
          {{ section.settings.email_icon_svg }}
        {%- else -%}
          {{- 'icon-email.svg' | inline_asset_content -}}
        {%- endif -%}
      </a>
      <a href="{{ section.settings.customer_service_url }}" class="header_simple_icon_item">
        {%- if section.settings.message_icon_svg != blank -%}
          {{ section.settings.message_icon_svg }}
        {%- else -%}
          {{- 'icon-message.svg' | inline_asset_content -}}
        {%- endif -%}
      </a>
      <a class="header_simple_icon_item header_simple_hamburger">
        <div open>
          {%- if section.settings.hamburger_icon_svg != blank -%}
            {{ section.settings.hamburger_icon_svg }}
          {%- else -%}
            {{- 'icon-hamburger.svg' | inline_asset_content -}}
          {%- endif -%}
        </div>
        <div close>
          {%- if section.settings.close_icon_svg != blank -%}
            {{ section.settings.close_icon_svg }}
          {%- else -%}
            {{- 'icon-close.svg' | inline_asset_content -}}
          {%- endif -%}
        </div>
      </a>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "header simple",
  "tag": "section",
  "class": "section",
  "disabled_on": {
    "groups": ["footer"],
    "templates": ["*"]
  },
  "settings": [
    {
      "type": "text",
      "id": "customer_service_url",
      "label": "Customer Service URL"
    },
    {
      "type": "header",
      "content": "图标设置"
    },
    {
      "type": "textarea",
      "id": "cart_icon_svg",
      "label": "购物车图标 SVG",
      "info": "留空则使用默认图标"
    },
    {
      "type": "textarea",
      "id": "email_icon_svg",
      "label": "邮箱图标 SVG",
      "info": "留空则使用默认图标"
    },
    {
      "type": "textarea",
      "id": "message_icon_svg",
      "label": "消息图标 SVG",
      "info": "留空则使用默认图标"
    },
    {
      "type": "textarea",
      "id": "hamburger_icon_svg",
      "label": "汉堡菜单图标 SVG",
      "info": "留空则使用默认图标"
    },
    {
      "type": "textarea",
      "id": "close_icon_svg",
      "label": "关闭图标 SVG",
      "info": "留空则使用默认图标"
    }
  ],
  "presets": [
    {
      "name": "header simple"
    }
  ]
}
{% endschema %}